<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Hello World in Backbone.js</title>
</head>
<body>
  <!-- ========= -->
  <!-- Your HTML -->
  <!-- ========= -->
  <div id='container'>Test</div>

  <section id='todoapp'>
    <header id='header'>
      <h1>Todos</h1>
      <input id='new-todo' placeholder='What needs to be done?'>
    </header>
    <section id='main'>
      <ul id='todo-list'></ul>
      <div id='books'></div>
    </section>
  </section>

  <!-- ========= -->
  <!-- Libraries -->
  <!-- ========= -->
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js" type="text/javascript"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js" type="text/javascript"></script>
  
  <!-- =============== -->
  <!-- Javascript code -->
  <!-- =============== -->

  <script type='text/template' id='book-template'>
    <ul>
      <% _.each(books, function(book) { %>
        <li><%= book['author'] %>--<%= book['title'] %></li>
      <% }); %>
    </ul> 
  </script>


  <script src="js/models/book.js"></script>
  <script src="js/collections/books.js"></script>
  <script src="js/views/app-view.js"></script>
  <script src="js/app.js"></script>


  <script type="text/javascript">
    // your JS code goes here
    var app = {};


    app.Book = Backbone.Model.extend({
      defaults: {
        title: '',
        author: ''
    	}
    });


    app.Books = Backbone.Collection.extend({
      url: '/books',
      model: app.Book,
      parse: function(data){
        return data.books;
      }
    });
    app.books = new app.Books();


    app.BooksView = Backbone.View.extend({
      el: '#books',
      template: _.template($('#book-template').html()),
      initialize: function(){
        this.listenTo(this.collection, 'sync change', this.render);
        this.collection.fetch();
        this.render();
      },
      render: function(){
        this.$el.html(this.template({
          books: this.collection.toJSON()
        }))
      }
    });
    var booksView = new app.BooksView({collection: app.books});


    app.Todo = Backbone.Model.extend({
      defaults: {
        title: '',
        completed: false
      }
    });


    var AppView = Backbone.View.extend({
        el: '#container',
      	template: _.template('<h3> Hello <%= who %> </h3>'),
      	initialize: function(){
      	  this.render();
      	},
      	render: function(){
      	  this.$el.html(this.template({who: 'Kyle!'}));
      	}
    });
    var appView = new AppView();

  </script>
  
</body>
</html>
